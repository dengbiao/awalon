# Task 1.4.2 设计并实现角色揭示界面

## 任务描述

设计并实现阿瓦隆游戏结束后的角色揭示界面，该界面将展示所有玩家的真实角色和阵营信息。角色揭示是游戏结束后的重要环节，能够满足玩家对游戏全貌的好奇心，并为玩家提供反思和学习的机会。

## 功能需求

1. **角色信息展示**

   - 显示所有玩家的名称、角色和阵营
   - 清晰区分好人阵营（亚瑟的忠臣）和坏人阵营（莫德雷德的爪牙）
   - 突出显示特殊角色（如梅林、刺客、莫甘娜等）

2. **角色能力说明**

   - 简要展示每个角色的特殊能力
   - 显示角色之间的关系（如谁能看到谁）
   - 可选择性地提供角色在游戏中的表现评价

3. **交互功能**

   - 支持点击角色卡片查看详细信息
   - 提供角色排序功能（按阵营、按座位顺序等）
   - 允许玩家查看特定角色之间的关系

4. **动画效果**
   - 设计角色卡片翻转或展示的动画效果
   - 为不同阵营的角色设计不同的视觉效果
   - 添加适当的音效增强揭示体验

## 界面需求

1. **视觉设计**

   - 好人阵营角色卡片使用光明、正义的色调（蓝色、金色等）
   - 坏人阵营角色卡片使用暗色、神秘的色调（紫色、红色等）
   - 设计符合中世纪传说风格的角色卡片和背景

2. **布局设计**

   - 以网格或环形布局展示所有玩家角色
   - 确保角色信息清晰可辨，不拥挤
   - 在有限空间内合理展示必要的角色信息
   - 适配不同尺寸的手机屏幕

3. **交互设计**
   - 设计直观的手势操作（如滑动查看更多角色）
   - 提供明确的视觉反馈，指示当前查看的角色
   - 确保所有按钮和交互元素尺寸合适，易于触控

## 技术需求

1. **渲染技术**

   - 使用 PIXI.js 实现高质量的 2D 渲染效果
   - 优化角色卡片和动画的渲染性能

2. **动画实现**

   - 使用 GSAP 库实现流畅的卡片翻转和展示动画
   - 实现角色关系的可视化动画（如连线效果）

3. **数据处理**

   - 从游戏状态中提取并处理所有玩家的角色信息
   - 构建角色之间的关系数据模型

4. **响应式设计**
   - 适配不同尺寸和分辨率的手机屏幕
   - 确保在不同设备上都能完整显示所有角色信息

## 实现步骤

1. **设计阶段**

   - 设计角色卡片的视觉样式和布局
   - 设计角色揭示的动画效果
   - 确定角色信息的展示方式和交互方式

2. **开发阶段**

   - 实现基础的角色卡片组件
   - 开发角色信息的数据处理逻辑
   - 实现角色卡片的动画效果
   - 添加交互功能和音效

3. **测试阶段**

   - 测试不同角色配置下的信息展示
   - 验证在不同设备上的显示效果
   - 确保动画效果流畅且不影响性能

4. **优化阶段**
   - 优化角色卡片的渲染性能
   - 调整动画效果和交互体验
   - 完善细节和过渡效果

## 界面原型

```
+----------------------------------+
|        角色揭示                   |
+----------------------------------+
|                                  |
|  +------+  +------+  +------+    |
|  |玩家1  |  |玩家2  |  |玩家3  |    |
|  |梅林   |  |忠臣   |  |莫甘娜 |    |
|  |[好]   |  |[好]   |  |[坏]   |    |
|  +------+  +------+  +------+    |
|                                  |
|  +------+  +------+  +------+    |
|  |玩家4  |  |玩家5  |  |玩家6  |    |
|  |派西维尔|  |刺客   |  |忠臣   |    |
|  |[好]   |  |[坏]   |  |[好]   |    |
|  +------+  +------+  +------+    |
|                                  |
|  [按阵营排序]  [按座位排序]        |
|                                  |
|  [返回结果]    [查看数据统计]      |
|                                  |
+----------------------------------+
```

## 数据结构

```typescript
// 角色信息接口
interface PlayerRoleInfo {
  playerId: string; // 玩家ID
  playerName: string; // 玩家名称
  role: Role; // 角色类型
  alignment: Alignment; // 阵营
  specialAbility: string; // 特殊能力描述
  visibleTo: string[]; // 对哪些角色可见
  seatPosition: number; // 座位位置
}

// 角色类型枚举
enum Role {
  MERLIN = "梅林",
  PERCIVAL = "派西维尔",
  LOYAL_SERVANT = "忠臣",
  ASSASSIN = "刺客",
  MORGANA = "莫甘娜",
  MORDRED = "莫德雷德",
  OBERON = "奥伯伦",
}

// 阵营枚举
enum Alignment {
  GOOD = "好人阵营",
  EVIL = "坏人阵营",
}
```

## 验收标准

1. **功能验收**

   - 正确显示所有玩家的角色和阵营信息
   - 特殊角色的能力说明准确完整
   - 角色之间的关系展示清晰
   - 交互功能（排序、详情查看等）正常工作

2. **界面验收**

   - 视觉设计符合游戏风格和主题
   - 不同阵营的角色有明显区分的视觉效果
   - 界面元素布局合理，信息清晰可读
   - 在不同尺寸的手机屏幕上显示正常

3. **技术验收**
   - 角色卡片渲染流畅，不出现卡顿
   - 动画效果自然，增强用户体验
   - 在低端设备上也能保持良好性能
   - 响应式设计正常工作

## 技术依赖

1. PIXI.js - 用于 2D 渲染
2. GSAP - 用于实现动画效果
3. 游戏状态管理模块 - 提供角色信息数据

## 工作量估计

- 设计工作：1 人日
- 开发工作：2 人日
- 测试和优化：1 人日
- 总计：4 人日

## 相关文档

- [阿瓦隆游戏规则](../../../阿瓦隆游戏规则.md)
- [角色能力关系图](../../../Epic5_游戏逻辑服务/Story5.2_游戏核心逻辑/角色能力关系图.md)
- [Story1.4 游戏结束界面 README](../README.md)
- [Story1.4 技术方案](../技术方案.md)
- [Task1.4.1 设计并实现游戏结果展示](./Task1.4.1_设计并实现游戏结果展示.md)
- [Task1.4.3 设计并实现游戏数据统计界面](./Task1.4.3_设计并实现游戏数据统计界面.md)
