# Task 1.3.1: 设计并实现角色信息展示界面

## 描述

设计并实现阿瓦隆游戏中的角色信息展示界面，包括游戏开始时的角色展示阶段和游戏过程中随时查看角色信息的功能。该界面需要清晰展示玩家自己的角色信息，以及根据角色可见性规则显示其他玩家的相关信息。

## 详细需求

### 功能需求

1. 角色初始展示

   - 游戏开始时，展示玩家自己的角色信息
   - 显示角色名称、阵营、能力描述和角色图标
   - 根据角色可见性规则，显示可见的其他玩家角色信息
   - 提供确认按钮，玩家确认后进入游戏主界面

2. 角色信息查看

   - 游戏过程中，玩家可随时点击自己的头像查看角色信息
   - 提供角色信息弹窗，包含完整的角色描述和能力说明
   - 显示与当前角色相关的可见信息（如梅林可见邪恶阵营）

3. 可见性规则实现

   - 根据不同角色的可见性规则，显示对应的信息
   - 梅林可见所有邪恶阵营角色（除莫德雷德外）
   - 派西维尔可见梅林和莫甘娜（但不知道谁是谁）
   - 邪恶阵营互相可见（除奥伯伦外）
   - 其他特殊角色的可见性规则

4. 界面交互
   - 角色信息卡片有翻转/展开动画效果
   - 可见角色信息有特殊标识或高亮效果
   - 提供角色规则说明的入口

### 界面要求

1. 角色信息卡片设计美观，符合中世纪/魔幻风格
2. 使用清晰的视觉元素区分好人/坏人阵营（如蓝色/红色）
3. 角色图标高质量，能清晰表达角色特点
4. 文字描述简洁明了，易于理解
5. 界面适配不同尺寸的设备屏幕
6. 动画效果流畅，增强用户体验

### 技术要求

1. 使用 PIXI.js 实现界面渲染和动画效果
2. 实现角色信息数据的动态加载和展示
3. 根据服务端提供的角色分配和可见性数据，正确显示信息
4. 优化资源加载，确保角色图片快速加载
5. 实现界面组件的复用，便于维护

## 实现步骤

1. 设计角色信息卡片的视觉样式
2. 实现角色初始展示界面的基本布局
3. 实现角色信息卡片组件
4. 实现角色可见性规则的逻辑
5. 实现游戏中查看角色信息的弹窗功能
6. 添加动画和交互效果
7. 进行多设备适配测试
8. 优化性能和用户体验

## 角色信息数据结构

```typescript
// 角色类型枚举
enum RoleType {
  MERLIN = "merlin", // 梅林
  ASSASSIN = "assassin", // 刺客
  PERCIVAL = "percival", // 派西维尔
  MORGANA = "morgana", // 莫甘娜
  MORDRED = "mordred", // 莫德雷德
  OBERON = "oberon", // 奥伯伦
  LOYAL_SERVANT = "loyal", // 亚瑟的忠臣
  MINION_OF_MORDRED = "minion", // 莫德雷德的爪牙
}

// 阵营枚举
enum Alignment {
  GOOD = "good", // 好人阵营
  EVIL = "evil", // 坏人阵营
}

// 角色信息
interface RoleInfo {
  type: RoleType; // 角色类型
  name: string; // 角色名称
  alignment: Alignment; // 阵营
  description: string; // 角色描述
  ability: string; // 角色能力
  iconUrl: string; // 角色图标URL
  visibleRoles?: RoleType[]; // 该角色可见的其他角色类型
}

// 玩家角色信息
interface PlayerRoleInfo {
  playerId: string; // 玩家ID
  playerName: string; // 玩家名称
  roleType: RoleType; // 角色类型
  isVisible: boolean; // 是否对当前玩家可见
  visibilityReason?: string; // 可见原因（如"你是梅林，能看到邪恶阵营"）
}
```

## 界面原型

```
+------------------------------------------+
|        角色信息展示 - 梅林视角            |
+------------------------------------------+
|                                          |
|                [光效]                    |
|          +----------------+              |
|          |                |              |
|          |    [角色图像]   |              |
|          |                |              |
|          |     梅林       |              |
|          |    好人阵营     |              |
|          |                |              |
|          +----------------+              |
|                                          |
|  角色能力:                               |
|  你能看到所有邪恶阵营的成员               |
|  (除了莫德雷德)                          |
|                                          |
|  你看到的邪恶阵营成员:                    |
|  +------+  +------+  +------+           |
|  |玩家2  |  |玩家5  |  |玩家7  |           |
|  |邪恶   |  |邪恶   |  |邪恶   |           |
|  +------+  +------+  +------+           |
|                                          |
|  提示: 保持你的身份秘密，不要被刺客发现！   |
|                                          |
|          [我已了解，开始游戏]             |
|                                          |
+------------------------------------------+

```

+------------------------------------------+
| 角色信息展示 - 莫甘娜视角 |
+------------------------------------------+
| |
| [光效] |
| +----------------+ |
| | | |
| | [角色图像] | |
| | | |
| | 莫甘娜 | |
| | 邪恶阵营 | |
| | | |
| +----------------+ |
| |
| 角色能力: |
| 你对帕西瓦尔显示为梅林 |
| 你知道其他邪恶阵营成员 |
| |
| 你的邪恶同伴: |
| +------+ +------+ |
| |玩家 3 | |玩家 6 | |
| |刺客 | |莫德雷德| |
| +------+ +------+ |
| |
| 提示: 混淆好人阵营，让他们误判梅林的身份！ |
| |
| [我已了解，开始游戏] |
| |
+------------------------------------------+

```

```

+------------------------------------------+
| 角色信息展示 - 忠臣视角 |
+------------------------------------------+
| |
| [光效] |
| +----------------+ |
| | | |
| | [角色图像] | |
| | | |
| | 忠臣 | |
| | 好人阵营 | |
| | | |
| +----------------+ |
| |
| 角色能力: |
| 你是亚瑟王的忠实追随者 |
| 你没有特殊能力，但你的使命是帮助好人阵营 |
| 找出邪恶势力并完成任务 |
| |
| 提示: 仔细观察其他玩家的行为，寻找线索！ |
| |
| [我已了解，开始游戏] |
| |
+------------------------------------------+

```

```

+------------------------------------------+
| 角色信息展示 - 帕西瓦尔视角 |
+------------------------------------------+
| |
| [光效] |
| +----------------+ |
| | | |
| | [角色图像] | |
| | | |
| | 帕西瓦尔 | |
| | 好人阵营 | |
| | | |
| +----------------+ |
| |
| 角色能力: |
| 你能看到梅林和莫甘娜，但不知道谁是谁 |
| |
| 你看到的可能是梅林的玩家: |
| +------+ +------+ |
| |玩家 1 | |玩家 4 | |
| | | | | |
| +------+ +------+ |
| |
| 提示: 观察这些玩家的行为，判断谁是真正的梅林！|
| |
| [我已了解，开始游戏] |
| |
+------------------------------------------+

```

```

+------------------------------------------+
| 角色信息展示 - 游戏中查看 |
+------------------------------------------+
| [关闭] |
| |
| +----------------+ |
| | | |
| | [角色图像] | |
| | | |
| | 梅林 | |
| | 好人阵营 | |
| | | |
| +----------------+ |
| |
| 角色能力: |
| 你能看到所有邪恶阵营的成员 |
| (除了莫德雷德) |
| |
| 你看到的邪恶阵营成员: |
| +------+ +------+ +------+ |
| |玩家 2 | |玩家 5 | |玩家 7 | |
| |邪恶 | |邪恶 | |邪恶 | |
| +------+ +------+ +------+ |
| |
| 提示: 保持你的身份秘密，不要被刺客发现！ |
| |
+------------------------------------------+

```

## 角色信息展示界面（文本描述）

角色信息展示界面是玩家了解自己角色和游戏信息的关键入口，设计遵循直观、美观、信息清晰的原则：

1. **初始角色展示**：

   - 游戏开始时，屏幕中央出现一张精美的角色卡片，带有翻转动画
   - 卡片正面显示角色图标、名称和阵营标识
   - 卡片背面显示详细的角色描述和能力说明
   - 好人阵营角色卡片使用蓝色基调，邪恶阵营使用红色基调
   - 卡片下方显示"点击查看详情"提示

2. **可见信息展示**：

   - 在角色卡片下方，显示"你能看到的信息"区域
   - 对于有特殊可见性的角色（如梅林），显示可见的其他玩家信息
   - 使用小型头像+角色图标的形式展示可见玩家
   - 对于派西维尔等无法确定具体角色的情况，使用问号标记表示可能性

3. **确认机制**：

   - 玩家查看完角色信息后，点击"我已了解"按钮
   - 按钮点击后有缩放动画，并播放确认音效
   - 所有玩家确认后，游戏正式开始

4. **游戏中查看**：

   - 游戏过程中，玩家可点击自己的头像查看角色信息
   - 弹出的角色信息窗口包含与初始展示相同的信息
   - 窗口右上角有关闭按钮，点击空白处也可关闭
   - 查看窗口有淡入淡出动画效果

5. **视觉设计**：
   - 使用中世纪风格的纹理和装饰元素
   - 角色图标采用手绘风格，形象鲜明
   - 重要信息使用较大字号和醒目颜色
   - 次要信息使用较小字号和柔和颜色
   - 整体色调与游戏主题一致，营造神秘氛围

通过这些设计，角色信息展示界面不仅能清晰传达游戏所需的关键信息，还能通过精美的视觉效果和流畅的动画增强玩家的游戏体验和沉浸感。

## 验收标准

1. 游戏开始时正确显示玩家的角色信息，包括角色名称、阵营、描述和图标
2. 根据角色可见性规则，正确显示可见的其他玩家信息
3. 角色信息卡片有美观的设计和流畅的动画效果
4. 游戏过程中可随时查看角色信息
5. 界面在不同尺寸的设备上显示正常，无布局错乱
6. 文字和图标清晰可辨，没有模糊或像素化现象
7. 动画效果流畅，无明显卡顿
8. 正确处理所有角色的可见性规则

## 技术依赖

- PIXI.js 渲染引擎
- GSAP 动画库
- 角色图标资源
- WebSocket 客户端（接收角色分配和可见性数据）

## 工作量估计

2 人天

## 相关文档

- [游戏角色设定](../../../阿瓦隆游戏规则.md)
- [角色能力关系图](../../../Epic5_游戏逻辑服务/Story5.2_游戏核心逻辑/角色能力关系图.md)
- [UI 设计稿链接](待补充)
```
